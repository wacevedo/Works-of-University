CREATE TABLE APROVEEDOR (
ID_PROVEEDOR NUMBER NOT NULL,
NOMBRE VARCHAR2(50) NOT NULL,
WEB VARCHAR2(25),
RUTA VARCHAR2(100),
TELEFONO NUMBER,
DIRECCION VARCHAR2 (50)
);

CREATE TABLE APRODUCTO (
ID_PROVEEDOR NUMBER NOT NULL,
ID_PRODUCTO NUMBER NOT NULL,
NOMBRE VARCHAR2 (10),
PRECIO NUMBER NOT NULL,
STOCK NUMBER NOT NULL
);

CREATE TABLE ACATEGORIA (
ID_CATEGORIA NUMBER NOT NULL,

NOMBRE VARCHAR2 (10),
DESCRIPCION VARCHAR2 (100)
);

CREATE TABLE AVENTA (
ID_VENTA NUMBER NOT NULL,
FECHA DATE,
MONTO NUMBER NOT NULL,
DESCUENTO NUMBER NOT NULL
);

CREATE TABLE ACLIENTE (
NOMBRE VARCHAR2 (10),
DIRECCION VARCHAR2 (50),
RUTA VARCHAR2 (100),
TELEFONO NUMBER
);

CREATE TABLE APRODUCTO_AVENTA (
ID_PRODUCTO NUMBER NOT NULL,
ID_VENTA NUMBER NOT NULL
);

SELECT COUNT(PV.ID_PRODUCTO),P.ID_PRODUCTO, CL.ID_CLIENTE,cl.nombre,SUM(v.monto)
FROM ACLIENTE CL,AVENTA V,aproducto_aventa PV,aproducto P
WHERE V.ID_CLIENTE=CL.ID_CLIENTE AND pv.id_producto=p.id_producto
AND pv.id_venta=v.id_venta
GROUP BY  CL.ID_CLIENTE,cl.nombre,P.ID_PRODUCTO
ORDER BY SUM(v.monto) DESC;

SELECT ve.id_vendedor,COUNT(PV.ID_PRODUCTO),p.id_producto,SUM(V.MONTO)
FROM AVENDEDOR VE,AVENTA V,aproducto_aventa PV,APRODUCTO P
WHERE pv.id_venta=v.id_venta AND V.ID_VENDEDOR=ve.id_vendedor
AND PV.ID_PRODUCTO= p.id_producto
GROUP BY ve.id_vendedor ,p.id_producto
ORDER BY SUM(V.MONTO) DESC;

SELECT ID_VENTA, MONTO
FROM AVENTA
WHERE FECHA BETWEEN '1/06/14' AND '31/07/14'
ORDER BY FECHA;
